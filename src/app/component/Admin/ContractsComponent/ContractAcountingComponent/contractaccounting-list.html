<nav style="background-color: #106861; color: white; padding: 0.5rem 1rem; border-bottom: 1px solid #145c36;" class="navbar navbar-expand-md">
    <!-- ============================================================== -->
    <!-- toggle and nav items -->
    <!-- ============================================================== -->
    <ul class="navbar-nav float-start me-auto">
      <li class="nav-item">
        <a class="nav-link waves-effect waves-dark" href="/admin/contracts" style="color: white;"> Contracts </a>
      </li>
      <li class="nav-item">
        <a class="nav-link waves-effect waves-dark" href="admin/contractAccounting"style="color: white;" > ContractAccounting </a>
       
      </li>
      <li class="nav-item">
        <a class="nav-link waves-effect waves-dark" href="admin/contractAccounting"style="color: white;" > ContractHolder </a>
       
      </li>
      <li class="nav-item">
        <a class="nav-link waves-effect waves-dark" href="admin/reporting"style="color: white;" > Reporting </a>
       
      </li>
     
    </ul>
    <!-- ============================================================== -->
    <!-- Right side toggle and nav items -->
    <!-- ============================================================== -->
    <ul class="navbar-nav float-end">
      <!-- ============================================================== -->
      <!-- User profile and search -->
      <!-- ============================================================== -->
      <li class="nav-item" ngbDropdown placement="bottom-end">
        <a
          ngbDropdownToggle
          class="nav-link waves-effect waves-dark pro-pic"
          href="javascript:void(0)"
          data-toggle="dropdown"
          aria-haspopup="true"
          aria-expanded="false"
        >
          
          <span class="ms-2" style="color: white;">Login</span>
        </a>
        <div class="dropdown-menu-right" ngbDropdownMenu>
          <a class="dropdown-item" href="javascript:void(0)"> My Profile</a>
          <a class="dropdown-item" href="javascript:void(0)"> My Balance</a>
          <a class="dropdown-item" href="javascript:void(0)"> Inbox</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="javascript:void(0)"> Account Setting</a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="javascript:void(0)"> Logout</a>
        </div>
      </li>
      <!-- ============================================================== -->
      <!-- User profile and search -->
      <!-- ============================================================== -->
    </ul>
    </nav>
    
<div class="container mt-4">
    <h2 class="mb-4">Liste des Comptes Contractuels</h2>
  
    <table class="table table-striped table-bordered">
      <thead class="thead-dark">
        <tr>
          <th>ID</th>
          <th>Matricule Fiscale</th>
          <th>Total Capital</th>
          <th>Indemnités Versées</th>
          <th>Total Provisions</th>
          <th>Créé le</th>
          <th>Mis à jour le</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let accounting of contractAccountings">
            <td>{{ accounting?.contract_accounting_id || '-' }}</td>
            <td>{{ accounting?.matriculeFiscale || '-' }}</td>
            <td>{{ accounting?.total_capital != null && accounting?.total_capital !== undefined ? (accounting.total_capital | number:'1.2-2') : '0.00' }}</td>
            <td>{{ accounting?.indemnites_versees != null && accounting?.indemnites_versees !== undefined ? (accounting.indemnites_versees | number:'1.2-2') : '0.00' }}</td>
            <td>{{ accounting?.totalProvisions != null && accounting?.totalProvisions !== undefined ? (accounting.totalProvisions | number:'1.2-2') : '0.00' }}</td>
            <td>{{ accounting?.created_at ? (accounting.created_at | date:'short') : '-' }}</td>
            <td>{{ accounting?.updated_at ? (accounting.updated_at | date:'short') : '-' }}</td>
            <td>
              <button class="btn btn-sm btn-warning me-2" (click)="editAccounting(accounting)">Modifier</button>
              <button class="btn btn-sm btn-danger" (click)="deleteAccounting(accounting.contract_accounting_id)">Supprimer</button>
            </td>
          </tr>
        
      </tbody>
    </table>
  </div>
  <hr class="my-5" />
<!-- Section pour ajouter un compte contractuel -->
<div class="container mt-4">
    <h2 class="mb-3">Ajouter un Compte Contractuel</h2>

    <div class="card p-4 shadow-sm rounded" style="background-color: #f8f9fa;">
      <form (ngSubmit)="addAccounting()" #accountingForm="ngForm">
        <div class="row mb-3">
          <div class="col-md-6 mb-3">
            <label class="form-label">Created At</label>
            <input type="date" class="form-control" name="created_at" [(ngModel)]="newAccounting.created_at" required />
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Matricule Fiscale</label>
            <input type="text" class="form-control" name="matriculeFiscale" [(ngModel)]="newAccounting.matriculeFiscale" required />
          </div>
        </div>
    
        <div class="row mb-3">
          <div class="col-md-6 mb-3">
            <label class="form-label">Total Capital</label>
            <input type="number" step="0.01" class="form-control" name="totalCapital" [(ngModel)]="newAccounting.total_capital" required />
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Updated At</label>
            <input type="date" class="form-control" name="updated_at" [(ngModel)]="newAccounting.updated_at" required />
          </div>
        </div>
    
        <div class="row mb-3">
          <div class="col-md-6 mb-3">
            <label class="form-label">Indemnités Versées</label>
            <input type="number" step="0.01" class="form-control" name="indemnitesVersees" [(ngModel)]="newAccounting.indemnites_versees" />
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">Total Provisions</label>
            <input type="number" step="0.01" class="form-control" name="totalProvisions" [(ngModel)]="newAccounting.totalProvisions" />
          </div>
        </div>
    
        <div class="text-center">
          <button type="submit" class="btn btn-success" [disabled]="!accountingForm.form.valid">
            Ajouter
          </button>
        </div>
      </form>
    </div>
    
</div>
<div class="container mt-4">
  <div class="row g-4">

    <!-- Capital Update -->
    <div class="col-md-4" *ngFor="let accounting of contractAccountings">
      <div class="card text-center shadow-sm h-100" (click)="updateCapital(accounting.matriculeFiscale)" style="cursor: pointer;">
        <div class="card-body">
          <img src="assets/images/capital.png" alt="Capital" class="img-fluid mb-3" style="width: 70px; height: 70px; object-fit: contain;" />
          <button class="btn btn-primary btn-sm">Mettre à jour le Capital</button>
        </div>
      </div>
    </div>

    <!-- Indemnités Update -->
    <div class="col-md-4" *ngFor="let accounting of contractAccountings">
      <div class="card text-center shadow-sm h-100" (click)="updateIndemnites(accounting.matriculeFiscale)" style="cursor: pointer;">
        <div class="card-body">
          <img src="assets/images/indemnites.png" alt="Indemnités" class="img-fluid mb-3" style="width: 70px; height: 70px; object-fit: contain;" />
          <button class="btn btn-primary btn-sm">Mettre à jour les Indemnités</button>
        </div>
      </div>
    </div>

    <!-- Bénéfice par Matricule -->
    <div class="col-md-4" *ngFor="let accounting of contractAccountings">
      <div class="card text-center shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">{{ accounting.matriculeFiscale }}</h5>
          <button class="btn btn-warning btn-sm mt-2" (click)="calculerBenefice(accounting.matriculeFiscale)">Calculer Bénéfice</button>
        </div>
      </div>
    </div>

    <!-- Bénéfice Total -->
    <div class="col-md-4">
      <div class="card text-center shadow-sm h-100" (click)="calculerBeneficeTotal()" style="cursor: pointer;">
        <div class="card-body">
          <img src="assets/images/total.png" alt="Total" class="img-fluid mb-3" style="width: 70px; height: 70px; object-fit: contain;" />
          <button class="btn btn-success btn-sm">Calculer Bénéfice Total</button>
        </div>
      </div>
    </div>

  </div>
</div>
