<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Esprit Insured Life - Analyse de Risque</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <style>
        :root {
            --primary-color: #4361ee;
            --secondary-color: #3f37c9;
            --accent-color: #4895ef;
            --danger-color: #f72585;
            --warning-color: #f77f00;
            --success-color: #4cc9f0;
            --info-color: #560bad;
            
            --text-primary: #212529;
            --text-secondary: #495057;
            --text-muted: #6c757d;
            
            --bg-dark: #212529;
            --bg-darker: #1a1e21;
            --bg-card: #ffffff;
            --bg-card-hover: #f8f9fa;
            
            --border-color: #dee2e6;
            
            --low-risk: #4cc9f0;
            --moderate-risk: #f77f00;
            --high-risk: #f72585;
        }

        body {
            font-family: 'Poppins', sans-serif;
            color: var(--text-primary);
            transition: all 0.3s ease;
            background-image: url('assets/images/background.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.92);
            z-index: -1;
            backdrop-filter: blur(2px);
        }

        .welcome-section {
            background: linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(245,245,255,0.98) 100%);
            color: var(--text-primary);
            text-align: center;
            padding: 50px 20px;
            border-radius: 20px;
            margin: 30px auto;
            max-width: 1200px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
            border: none;
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
        }

        .welcome-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .welcome-section::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color), var(--success-color));
            animation: rainbow 8s linear infinite;
            background-size: 400% 100%;
        }

        @keyframes rainbow {
            0% { background-position: 0% 50% }
            50% { background-position: 100% 50% }
            100% { background-position: 0% 50% }
        }

        .welcome-header {
            margin-bottom: 20px;
            position: relative;
        }

        .title-word {
            display: inline-block;
            animation: floatText 3s ease-in-out infinite;
            font-size: 2.8rem;
            margin: 0 5px;
            color: var(--primary-color);
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
        }

        .title-word::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 3px;
            background: currentColor;
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.3s ease;
        }

        .title-word:hover::after {
            transform: scaleX(1);
            transform-origin: left;
        }

        .title-word-2 { animation-delay: 0.3s; color: var(--accent-color); }
        .title-word-3 { animation-delay: 0.6s; color: var(--success-color); }

        @keyframes floatText {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .welcome-lead {
            font-size: 1.3rem;
            opacity: 0.9;
            margin-bottom: 20px;
            color: var(--text-secondary);
            position: relative;
            display: inline-block;
        }

        .welcome-lead::after {
            content: "";
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            border-radius: 3px;
        }

        .dashboard-container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 2.5rem;
            display: block;
            background: linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(245,245,255,0.98) 100%);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.12);
            border: none;
            position: relative;
            overflow: hidden;
            transition: all 0.5s ease;
            margin-bottom: 50px;
        }

        .dashboard-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .dashboard-container h2 {
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            color: var(--primary-color);
            position: relative;
            display: inline-block;
        }

        .dashboard-container h2::after {
            content: "";
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--accent-color);
            border-radius: 3px;
        }

        .dashboard-container p {
            font-size: 1.1rem;
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

        .card {
            background-color: var(--bg-card);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            border: none;
            margin-bottom: 25px;
        }

        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
            background-color: var(--bg-card-hover);
        }

        .card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--primary-color);
            transition: all 0.3s ease;
        }

        .card:hover::before {
            width: 8px;
            background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 15px 15px 0 0 !important;
            padding: 15px 20px;
            border: none;
        }

        .card-header h4 {
            margin: 0;
            font-weight: 600;
        }

        .card-body {
            padding: 20px;
        }

        .value {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--text-primary);
            margin: 15px 0;
            position: relative;
            display: inline-block;
        }

        .value::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: rgba(0,0,0,0.1);
        }

        .alert {
            color: var(--danger-color);
            font-weight: 600;
            padding: 8px 12px;
            border-radius: 6px;
            background-color: rgba(247, 37, 133, 0.1);
            margin: 5px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .alert:hover {
            background-color: rgba(247, 37, 133, 0.2);
            transform: translateX(5px);
        }

        .alert i {
            font-size: 1.1rem;
        }

        ul {
            padding-left: 0;
            list-style: none;
        }

        ul li {
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            padding-left: 25px;
        }

        ul li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            color: var(--accent-color);
            font-size: 1.5rem;
        }

        .risk-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 5px 0;
            background-color: rgba(0,0,0,0.03);
            transition: all 0.3s ease;
        }

        .risk-item:hover {
            background-color: rgba(0,0,0,0.08);
            transform: translateX(5px);
        }

        .risk-item .risk-value {
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .low-risk { color: var(--low-risk); }
        .moderate-risk { color: var(--moderate-risk); }
        .high-risk { color: var(--high-risk); }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card:nth-child(1) { animation: fadeIn 0.5s ease forwards; }
        .card:nth-child(2) { animation: fadeIn 0.7s ease forwards; }
        .card:nth-child(3) { animation: fadeIn 0.9s ease forwards; }
        .card:nth-child(4) { animation: fadeIn 1.1s ease forwards; }

        /* Pulse animation for important elements */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Floating elements */
        .floating {
            animation: floating 3s ease-in-out infinite;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Risk gauge styles */
        .risk-gauge {
            position: relative;
            width: 250px;
            height: 250px;
            margin: 0 auto;
        }

        .gauge-label {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -30%);
            text-align: center;
        }

        .gauge-label h2 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0;
        }

        .gauge-label small {
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        /* Timeline styles */
        .timeline {
            position: relative;
            padding-left: 50px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--border-color);
        }

        .timeline-item {
            position: relative;
            padding-bottom: 25px;
        }

        .timeline-item.current {
            background-color: rgba(67, 97, 238, 0.05);
            padding: 15px;
            border-radius: 8px;
            margin-left: -15px;
            margin-right: -15px;
        }

        .timeline-badge {
            position: absolute;
            left: -40px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            background-color: white;
            border: 2px solid var(--border-color);
        }

        .trend-up {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }

        .trend-down {
            color: var(--success-color);
            border-color: var(--success-color);
        }

        .trend-neutral {
            color: var(--text-muted);
            border-color: var(--text-muted);
        }

        .timeline-content {
            padding-left: 15px;
        }

        .timeline-content h6 {
            font-weight: 600;
            margin-bottom: 5px;
        }

        /* Extracted info cards */
        .extracted-info-card {
            border-left: 4px solid;
            transition: all 0.3s ease;
            height: 100%;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .extracted-info-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .info-card-age { border-left-color: var(--accent-color); }
        .info-card-medical { border-left-color: var(--danger-color); }
        .info-card-lifestyle { border-left-color: var(--success-color); }
        .info-card-family { border-left-color: var(--secondary-color); }

        .info-icon-lg {
            font-size: 1.75rem;
            margin-bottom: 15px;
        }

        .info-value {
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* Confetti animation */
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            opacity: 0;
            background-color: #f00;
            animation: confetti 5s ease-in-out infinite;
        }

        .confetti:nth-child(1) { background-color: #f00; left: 10%; top: -10%; animation-delay: 0.5s; }
        .confetti:nth-child(2) { background-color: #0f0; left: 20%; top: -5%; animation-delay: 1s; }
        .confetti:nth-child(3) { background-color: #00f; left: 30%; top: -8%; animation-delay: 1.5s; }
        .confetti:nth-child(4) { background-color: #ff0; left: 70%; top: -10%; animation-delay: 0.8s; }
        .confetti:nth-child(5) { background-color: #f0f; left: 85%; top: -5%; animation-delay: 1.2s; }

        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(500px) rotate(360deg); opacity: 0; }
        }

        /* Feedback bubble */
        .feedback-bubble {
            box-shadow: 0 10px 20px rgba(76, 201, 240, 0.3);
            animation: pulse 2s infinite;
            background: linear-gradient(135deg, var(--success-color), var(--accent-color));
            color: white;
            border-radius: 50%;
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 180px;
            height: 180px;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .title-word {
                font-size: 2rem;
            }
            
            .welcome-lead {
                font-size: 1.1rem;
            }
            
            .dashboard-container {
                padding: 1.5rem;
            }
            
            .risk-gauge {
                width: 200px;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Section -->
    <section class="welcome-section">
        <div class="welcome-header">
            <h1>
                <span class="title-word title-word-1">Esprit</span>
                <span class="title-word title-word-2">Insured</span>
                <span class="title-word title-word-3">Life</span>
            </h1>
            <p class="welcome-lead">Analyse de risque intelligente et dynamique</p>
        </div>
    </section>

    <!-- Main Content -->
    <div class="dashboard-container">
        <div class="row">
            <div class="col-lg-12">
            </div>

            <div class="col-lg-12">
                <div class="card">
                    <div class="card-header">
                        <h4>T√©l√©versement de fichier</h4>
                    </div>
                    <div class="card-body">
                        <form (ngSubmit)="onSubmit()" enctype="multipart/form-data">
                            <div class="form-group mb-3">
                                <label for="userId" class="form-label">Assessment ID:</label>
                                <input 
                                    type="number" 
                                    id="userId" 
                                    class="form-control" 
                                    [(ngModel)]="userId" 
                                    name="userId" 
                                    required>
                            </div>
                          
                            <div class="form-group mb-3">
                                <label for="medicalRecord" class="form-label">T√©l√©verser Fichier M√©dical (.pdf):</label>
                                <input 
                                    type="file" 
                                    id="medicalRecord" 
                                    class="form-control" 
                                    (change)="onFileSelected($event)" 
                                    accept=".pdf" 
                                    required>
                            </div>
                          
                            <div class="form-group mb-3">
                                <label for="riskFactorIds" class="form-label">Facteurs de Risque (IDs):</label>
                                <input 
                                    type="text" 
                                    id="riskFactorIds" 
                                    class="form-control" 
                                    [(ngModel)]="riskFactorIdsInput" 
                                    name="riskFactorIds">
                                <small class="form-text text-muted">
                                    Entrez les IDs des facteurs de risque s√©par√©s par des virgules (ex: 1,2,3)
                                </small>
                            </div>
                          
                            <div class="form-group mb-3">
                                <label for="userWhatsapp" class="form-label">Num√©ro WhatsApp:</label>
                                <input 
                                    type="text" 
                                    id="userWhatsapp" 
                                    class="form-control" 
                                    [(ngModel)]="userWhatsapp" 
                                    name="userWhatsapp">
                            </div>
                          
                            <button type="submit" class="btn btn-primary mt-3">Envoyer</button>
                        </form>        
                    </div>
                </div>
            </div>

            <div class="col-lg-12">
                <div class="card">
                    <div class="card-header">
                        <h4><i class="fas fa-clipboard-list me-2"></i>üìã D√©tails des Informations Extraites</h4>
                    </div>
                    <div class="card-body">
                        <!-- Champ d'entr√©e pour l'ID de l'utilisateur -->
                        <div class="mb-4">
                            <label for="userId" class="form-label">ID Utilisateur</label>
                            <input type="number" class="form-control" id="userId" [(ngModel)]="userId" placeholder="Entrez l'ID de l'utilisateur">
                        </div>
                        <div class="mb-4 text-end">
                            <button type="button" class="btn btn-primary" (click)="onSearch()">
                                <i class="fas fa-search me-2"></i>Rechercher
                            </button>
                        </div>
                      
                        <!-- Affichage des informations de l'√©valuation de risque -->
                        <div *ngIf="riskAssessment">
                            <div class="row">
                                <div class="col-md-6 col-lg-3 mb-4">
                                    <div class="card info-card age h-100">
                                        <div class="card-body text-center">
                                            <div class="info-icon text-info">
                                                <i class="fas fa-birthday-cake"></i>
                                            </div>
                                            <h5>√Çge</h5>
                                            <p class="display-6">{{ riskAssessment.age }} ans</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-3 mb-4">
                                    <div class="card info-card medical h-100">
                                        <div class="card-body text-center">
                                            <div class="info-icon text-danger">
                                                <i class="fas fa-heartbeat"></i>
                                            </div>
                                            <h5>Historique M√©dical</h5>
                                            <ul class="list-unstyled">
                                                <li *ngFor="let disease of riskAssessment.chronicDiseaseArray">
                                                    <i class="fas fa-check text-success me-2"></i>{{ disease }}
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-3 mb-4">
                                    <div class="card info-card price h-100">
                                        <div class="card-body text-center">
                                            <div class="info-icon text-warning">
                                                <i class="fas fa-dollar-sign"></i>
                                            </div>
                                            <h5>Prix</h5>
                                            <p class="display-6">{{ riskAssessment.price | currency:'EUR' }}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6 col-lg-3 mb-4">
                                    <div class="card info-card risk-score h-100">
                                        <div class="card-body text-center">
                                            <div class="info-icon text-primary">
                                                <i class="fas fa-exclamation-triangle"></i>
                                            </div>
                                            <h5>Risk Score</h5>
                                            <p class="display-6">{{ riskAssessment.riskScore }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                      
                        <!-- Message d'erreur -->
                        <div *ngIf="errorMessage" class="alert alert-danger">
                            {{ errorMessage }}
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-12">
                <div class="card">
                    <div class="card-header">
                        <h4>üéØ √âvaluation du Risque</h4>
                    </div>
                    <div class="card-body">
                        <div class="row align-items-center">
                            <div class="col-md-6 text-center">
                                <div class="risk-gauge mx-auto">
                                    <canvas id="riskGauge2"></canvas>
                                    <div class="gauge-label">
                                        <h2 class="mb-0 fw-bold" id="riskScoreValue2">{{ riskAssessment.riskScore }}</h2>
                                        <small class="text-muted">SCORE DE RISQUE</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="risk-category mb-4">
                                    <h5 class="d-flex justify-content-between">
                                        <span>Niveau de Risque:</span>
                                        <span class="badge bg-danger" id="riskLevel2">√âlev√©</span>
                                    </h5>
                                    <div class="progress" style="height:10px;">
                                        <div class="progress-bar bg-gradient-danger" role="progressbar" style="width:72%"></div>
                                    </div>
                                </div>
                                <div class="risk-details">
                                    <h5><i class="fas fa-exclamation-triangle me-2"></i>Recommandations</h5>
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Rev√©rifier les documents joints</li>
                                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Demander une v√©rification manuelle</li>
                                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Contacter le client pour confirmation</li>
                                    </ul>
                                </div>
                                <button class="btn btn-outline-danger mt-3">
                                    <i class="fas fa-redo me-2"></i>Recalculer le Score
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Animation au chargement de la page
            const titleWords = document.querySelectorAll('.title-word');
            titleWords.forEach((word, index) => {
                word.style.animationDelay = `${index * 0.3}s`;
            });
            
            // Effet de scroll pour les cartes
            const cards = document.querySelectorAll('.card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animationPlayState = 'running';
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1 });
            
            cards.forEach(card => {
                card.style.animationPlayState = 'paused';
                observer.observe(card);
            });
            
            // Risk gauge chart
            const ctx2 = document.getElementById('riskGauge2').getContext('2d');
            const riskScore = 72;
            new Chart(ctx2, {
                type: 'doughnut',
                data: {
                    datasets: [{
                        data: [riskScore, 100-riskScore],
                        backgroundColor: [
                            getRiskColor(riskScore),
                            '#e9ecef'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    circumference: 180,
                    rotation: -90,
                    cutout: '80%',
                    plugins: { legend: { display: false } },
                    tooltips: { enabled: false }
                }
            });
            
            document.getElementById('riskScoreValue2').textContent = riskScore;
            document.getElementById('riskLevel2').textContent = 
                riskScore > 75 ? 'Tr√®s √©lev√©' :
                riskScore > 50 ? '√âlev√©' :
                riskScore > 25 ? 'Mod√©r√©' : 'Faible';
            
            function getRiskColor(score) {
                if (score > 75) return '#f72585';
                if (score > 50) return '#f77f00';
                if (score > 25) return '#ffc107';
                return '#4cc9f0';
            }
            
            // Simulation de donn√©es dynamiques (pour la d√©mo)
            setInterval(() => {
                const valueElements = document.querySelectorAll('.value');
                valueElements.forEach(el => {
                    el.classList.add('pulse');
                    setTimeout(() => {
                        el.classList.remove('pulse');
                    }, 1000);
                });
            }, 5000);
        });
    </script>
</body>
</html>